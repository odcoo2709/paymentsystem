<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Order & Wallet Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Apple SD Gothic Neo', -apple-system, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #2c3e50 0%, #1a1a2e 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .admin-container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
        }

        .admin-header {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .admin-title {
            font-size: 32px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #3498db, #2ecc71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }

        .admin-subtitle {
            color: #7f8c8d;
            font-size: 16px;
            text-align: center;
        }

        .language-switcher {
            position: absolute;
            top: 20px;
            right: 25px;
        }

        .lang-switch-btn {
            background: linear-gradient(135deg, #3498db 0%, #2ecc71 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .lang-switch-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .lang-icon {
            font-size: 16px;
        }

        .tabs {
            display: flex;
            background: white;
            border-radius: 10px;
            margin-bottom: 25px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .tab-button {
            flex: 1;
            padding: 18px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: bold;
            color: #7f8c8d;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .tab-button:hover {
            background: #f8f9fa;
        }

        .tab-button.active {
            color: #3498db;
            background: white;
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: #3498db;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .stat-card h3 {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-change {
            font-size: 14px;
            color: #27ae60;
        }

        .stat-change.negative {
            color: #e74c3c;
        }

        .orders-section, .wallets-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 25px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }

        .filter-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-select, .search-box {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        .search-box {
            width: 250px;
        }

        .refresh-button, .add-button {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }

        .add-button {
            background: #27ae60;
        }

        .refresh-button:hover {
            background: #2980b9;
        }

        .add-button:hover {
            background: #219653;
        }

        .export-button {
            padding: 10px 20px;
            background: #9b59b6;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }

        .export-button:hover {
            background: #8e44ad;
        }

        .orders-table-container, .wallets-table-container {
            overflow-x: auto;
        }

        .orders-table, .wallets-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }

        .wallets-table {
            min-width: 800px;
        }

        .orders-table th, .wallets-table th {
            background: #f8f9fa;
            padding: 15px;
            text-align: left;
            font-weight: bold;
            color: #2c3e50;
            border-bottom: 2px solid #dee2e6;
        }

        .orders-table td, .wallets-table td {
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
            vertical-align: middle;
        }

        .orders-table tr:hover, .wallets-table tr:hover {
            background: #f8f9fa;
        }

        .order-id, .wallet-id {
            font-weight: bold;
            color: #2c3e50;
            font-family: monospace;
        }

        .order-time {
            font-size: 12px;
            color: #7f8c8d;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            text-align: center;
            min-width: 80px;
        }

        .status-waiting { background: #f39c12; }
        .status-confirmed { background: #3498db; }
        .status-processing { background: #9b59b6; }
        .status-completed { background: #27ae60; }
        .status-cancelled { background: #e74c3c; }

        .wallet-status {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            text-align: center;
            min-width: 80px;
        }

        .wallet-active { background: #27ae60; }
        .wallet-inactive { background: #95a5a6; }

        .network-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: bold;
            color: white;
            margin-right: 5px;
        }

        .network-trc20 { background: #e74c3c; }
        .network-erc20 { background: #3498db; }
        .network-bep20 { background: #2ecc71; }
        .network-solana { background: #9b59b6; }
        .network-polygon { background: #8e44ad; }

        .action-buttons {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .action-button {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .action-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .action-view { background: #3498db; color: white; }
        .action-confirm { background: #2ecc71; color: white; }
        .action-process { background: #9b59b6; color: white; }
        .action-complete { background: #27ae60; color: white; }
        .action-cancel { background: #e74c3c; color: white; }
        .action-reset { background: #f39c12; color: white; }
        .action-edit { background: #3498db; color: white; }
        .action-delete { background: #e74c3c; color: white; }
        .action-activate { background: #2ecc71; color: white; }
        .action-deactivate { background: #95a5a6; color: white; }
        .action-setdefault { background: #f39c12; color: white; }

        .no-orders, .no-wallets {
            text-align: center;
            padding: 50px;
            color: #95a5a6;
            font-size: 16px;
        }

        .amount-display {
            font-weight: bold;
            color: #2c3e50;
        }

        .progress-indicator {
            width: 100px;
            height: 6px;
            background: #ecf0f1;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-bar {
            height: 100%;
            background: #3498db;
            border-radius: 3px;
            transition: width 0.3s;
        }

        .wallet-address {
            font-family: monospace;
            font-size: 12px;
            color: #2c3e50;
            word-break: break-all;
            background: #f8f9fa;
            padding: 8px;
            border-radius: 6px;
            margin-top: 5px;
            border: 1px solid #e9ecef;
        }

        .qr-code-small {
            width: 80px;
            height: 80px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #dee2e6;
            margin: 0 auto;
        }

        .qr-code-small img {
            max-width: 100%;
            max-height: 100%;
            border-radius: 4px;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 600px;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.4);
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #95a5a6;
            cursor: pointer;
        }

        .modal-body {
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .modal-button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-button.primary {
            background: #3498db;
            color: white;
        }

        .modal-button.secondary {
            background: #ecf0f1;
            color: #2c3e50;
        }

        .modal-button.success {
            background: #27ae60;
            color: white;
        }

        .modal-button.danger {
            background: #e74c3c;
            color: white;
        }

        .modal-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .hidden {
            display: none;
        }

        .time-filter {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .time-input {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .active-wallet-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #2ecc71;
            border-radius: 50%;
            margin-right: 5px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .default-wallet-badge {
            display: inline-block;
            padding: 2px 8px;
            background: #f39c12;
            color: white;
            font-size: 10px;
            border-radius: 10px;
            margin-left: 5px;
        }

        .wallet-actions {
            display: flex;
            gap: 5px;
            justify-content: center;
        }

        .total-row {
            background: #f8f9fa;
            font-weight: bold;
        }

        .save-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1001;
            display: none;
        }

        .save-status.show {
            display: block;
            animation: fadeInOut 3s ease-in-out;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(20px); }
            20% { opacity: 1; transform: translateY(0); }
            80% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(20px); }
        }

        .sync-badge {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #3498db;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
            z-index: 1000;
        }

        .sync-dot {
            width: 8px;
            height: 8px;
            background: #2ecc71;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        @media (max-width: 768px) {
            .admin-container {
                padding: 10px;
            }
            
            .stats-cards {
                grid-template-columns: 1fr;
            }
            
            .section-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .filter-controls {
                width: 100%;
                flex-wrap: wrap;
            }
            
            .search-box {
                width: 100%;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .language-switcher {
                position: relative;
                top: 0;
                right: 0;
                margin-top: 15px;
                text-align: center;
            }
        }

        /* í…”ë ˆê·¸ë¨ ì„¤ì • ì…ë ¥ë€ */
        .telegram-settings {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #e2e8f0;
        }

        .telegram-settings h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .test-telegram-btn {
            background: #0088cc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
        }

        .test-telegram-btn:hover {
            background: #0077b3;
        }

        .telegram-status {
            font-size: 12px;
            color: #718096;
            margin-top: 5px;
            display: block;
        }

        .telegram-status.success {
            color: #27ae60;
        }

        .telegram-status.error {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <!-- ë™ê¸°í™” ë°°ì§€ -->
    <div class="sync-badge" id="syncBadge">
        <div class="sync-dot"></div>
        <span id="syncStatusText">ì‹¤ì‹œê°„ ë™ê¸°í™”</span>
    </div>
    
    <div class="admin-container">
        <!-- í—¤ë” -->
        <div class="admin-header">
            <div class="language-switcher">
                <button class="lang-switch-btn" id="langSwitchBtn">
                    <span class="lang-icon">ğŸŒ</span>
                    <span id="langSwitchText">English</span>
                </button>
            </div>
            <h1 class="admin-title" id="adminTitle">ğŸ“Š ì£¼ë¬¸ ë° ì§€ê°‘ ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
            <p class="admin-subtitle" id="adminSubtitle">í•œ ê³³ì—ì„œ ì‚¬ìš©ì ì£¼ë¬¸ê³¼ ì§€ê°‘ ì„¤ì •ì„ ê´€ë¦¬í•˜ì„¸ìš”</p>
        </div>

        <!-- í…”ë ˆê·¸ë¨ ì„¤ì • -->
        <div class="telegram-settings">
            <h3>ğŸ¤– í…”ë ˆê·¸ë¨ ì•Œë¦¼ ì„¤ì •</h3>
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">ë´‡ í† í° (Bot Token)</label>
                    <input type="text" class="form-input" id="telegramBotToken" 
                           placeholder="ì˜ˆ: 1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZ">
                </div>
                <div class="form-group">
                    <label class="form-label">ì±„íŒ… ID (Chat ID)</label>
                    <input type="text" class="form-input" id="telegramChatId" 
                           placeholder="ì˜ˆ: 1234567890">
                </div>
            </div>
            <button class="test-telegram-btn" id="testTelegramBtn">í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ì „ì†¡</button>
            <span class="telegram-status" id="telegramStatus"></span>
            <small style="color: #718096; display: block; margin-top: 10px;">
                * ë´‡ ìƒì„± ë°©ë²•: í…”ë ˆê·¸ë¨ì—ì„œ @BotFather ê²€ìƒ‰ â†’ /newbot â†’ ë´‡ ì´ë¦„ ì„¤ì • â†’ í† í° ë°œê¸‰ë°›ê¸°<br>
                * ì±„íŒ… ID í™•ì¸: @getidsbot ê²€ìƒ‰ â†’ Start â†’ Your Chat ID í™•ì¸
            </small>
        </div>

        <!-- íƒ­ ë©”ë‰´ -->
        <div class="tabs">
            <button class="tab-button active" data-tab="orders">ğŸ“‹ ì£¼ë¬¸ ê´€ë¦¬</button>
            <button class="tab-button" data-tab="wallets">ğŸ‘› ì§€ê°‘ ê´€ë¦¬</button>
        </div>

        <!-- í†µê³„ ì¹´ë“œ -->
        <div class="stats-cards">
            <div class="stat-card">
                <h3 id="statTotalOrders">ì´ ì£¼ë¬¸</h3>
                <div class="stat-value" id="totalOrders">0</div>
                <div class="stat-change" id="statTotalChange">ì „ì²´ ì£¼ë¬¸</div>
            </div>
            <div class="stat-card">
                <h3 id="statWaiting">ì…ê¸ˆ ëŒ€ê¸°</h3>
                <div class="stat-value" id="waitingOrders">0</div>
                <div class="stat-change" id="waitingChange">ëŒ€ê¸°ì¤‘</div>
            </div>
            <div class="stat-card">
                <h3 id="statActiveWallets">í™œì„± ì§€ê°‘</h3>
                <div class="stat-value" id="activeWallets">0</div>
                <div class="stat-change" id="walletsChange">ì‚¬ìš© ê°€ëŠ¥</div>
            </div>
            <div class="stat-card">
                <h3 id="statTodayRevenue">ì˜¤ëŠ˜ ìˆ˜ìµ</h3>
                <div class="stat-value" id="todayRevenue">0 THB</div>
                <div class="stat-change" id="revenueChange">ìˆ˜ìˆ˜ë£Œ 3%</div>
                <div class="stat-value" style="font-size: 16px; color: #7f8c8d;" id="todayRevenueUSDT">(0 USDT)</div>
            </div>
            <div class="stat-card">
                <h3 id="statTodayAmount">ì˜¤ëŠ˜ ê±°ë˜ì•¡</h3>
                <div class="stat-value" id="todayAmount">0 THB</div>
                <div class="stat-change" id="amountChange">ì´ ê±°ë˜ì•¡</div>
                <div class="stat-value" style="font-size: 16px; color: #7f8c8d;" id="todayAmountUSDT">(0 USDT)</div>
            </div>
        </div>

        <!-- ì£¼ë¬¸ ê´€ë¦¬ íƒ­ -->
        <div id="ordersTab" class="tab-content active">
            <div class="orders-section">
                <div class="section-header">
                    <h2 class="section-title" id="ordersTitle">ğŸ“‹ ì£¼ë¬¸ ëª©ë¡</h2>
                    <div class="filter-controls">
                        <input type="text" class="search-box" id="searchOrder" placeholder="ì£¼ë¬¸ ID ê²€ìƒ‰...">
                        <select class="filter-select" id="statusFilter">
                            <option value="all">ëª¨ë“  ìƒíƒœ</option>
                            <option value="ì…ê¸ˆëŒ€ê¸°">ì…ê¸ˆ ëŒ€ê¸°</option>
                            <option value="ì…ê¸ˆí™•ì¸">ì…ê¸ˆ í™•ì¸</option>
                            <option value="ì²˜ë¦¬ì¤‘">ì²˜ë¦¬ì¤‘</option>
                            <option value="ì™„ë£Œ">ì™„ë£Œ</option>
                            <option value="ì·¨ì†Œ">ì·¨ì†Œ</option>
                        </select>
                        <div class="time-filter">
                            <input type="date" class="time-input" id="dateFrom">
                            <span>~</span>
                            <input type="date" class="time-input" id="dateTo">
                        </div>
                        <button class="export-button" id="exportOrders">ğŸ“¥ ì €ì¥í•˜ê¸°</button>
                        <button class="refresh-button" id="refreshOrders">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                    </div>
                </div>

                <div class="orders-table-container">
                    <table class="orders-table" id="ordersTable">
                        <thead>
                            <tr>
                                <th id="thOrderId">ì£¼ë¬¸ ID(Order ID)</th>
                                <th id="thAmount">ê¸ˆì•¡ (THB)</th>
                                <th id="thWallet">ì…ê¸ˆ ì§€ê°‘</th>
                                <th id="thStatus">ìƒíƒœ</th>
                                <th id="thStep">ì§„í–‰ ë‹¨ê³„</th>
                                <th id="thProof">ìœ ì € ìš”ì²­ì„œ</th>
                                <th id="thAction">ê²°ì œ ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody">
                            <tr>
                                <td colspan="7" class="no-orders" id="noOrdersText">ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ì§€ê°‘ ê´€ë¦¬ íƒ­ -->
        <div id="walletsTab" class="tab-content">
            <div class="wallets-section">
                <div class="section-header">
                    <h2 class="section-title" id="walletsTitle">ğŸ‘› ì§€ê°‘ ëª©ë¡</h2>
                    <div class="filter-controls">
                        <select class="filter-select" id="walletStatusFilter">
                            <option value="all">ëª¨ë“  ìƒíƒœ</option>
                            <option value="active">í™œì„±</option>
                            <option value="inactive">ë¹„í™œì„±</option>
                        </select>
                        <select class="filter-select" id="walletNetworkFilter">
                            <option value="all">ëª¨ë“  ë„¤íŠ¸ì›Œí¬</option>
                            <option value="TRC20">TRC20</option>
                            <option value="ERC20">ERC20</option>
                            <option value="BEP20">BEP20</option>
                            <option value="Solana">Solana</option>
                            <option value="Polygon">Polygon</option>
                        </select>
                        <button class="add-button" id="addWallet">â• ìƒˆ ì§€ê°‘ ì¶”ê°€</button>
                        <button class="refresh-button" id="refreshWallets">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                    </div>
                </div>

                <div class="wallets-table-container">
                    <table class="wallets-table" id="walletsTable">
                        <thead>
                            <tr>
                                <th id="thWalletName">ì´ë¦„</th>
                                <th id="thNetwork">ë„¤íŠ¸ì›Œí¬</th>
                                <th id="thAddress">ì£¼ì†Œ</th>
                                <th id="thQRCode">QR ì½”ë“œ</th>
                                <th id="thWalletStatus">ìƒíƒœ</th>
                                <th id="thCreated">ìƒì„±ì¼</th>
                                <th id="thWalletAction">ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="walletsTableBody">
                            <tr>
                                <td colspan="7" class="no-wallets" id="noWalletsText">ì§€ê°‘ì´ ì—†ìŠµë‹ˆë‹¤. ìƒˆ ì§€ê°‘ì„ ì¶”ê°€í•˜ì„¸ìš”.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <h3 style="color: #2c3e50; margin-bottom: 15px;" id="walletGuideTitle">ğŸ’¡ ì§€ê°‘ ê´€ë¦¬ ì•ˆë‚´</h3>
                    <ul style="color: #4a5568; line-height: 1.6; padding-left: 20px;" id="walletGuideList">
                        <li>ì—¬ëŸ¬ ê°œì˜ ì§€ê°‘ì„ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                        <li><strong>í™œì„± ì§€ê°‘</strong>ì€ ì‚¬ìš©ì í˜ì´ì§€ì— í‘œì‹œë©ë‹ˆë‹¤.</li>
                        <li><strong>ê¸°ë³¸ ì§€ê°‘</strong>ì€ ì‚­ì œí•  ìˆ˜ ì—†ì§€ë§Œ í™œì„± ìƒíƒœëŠ” ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                        <li>ê° ì§€ê°‘ì— ëŒ€í•œ QR ì½”ë“œ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                        <li>ë„¤íŠ¸ì›Œí¬ ìœ í˜•ë³„ë¡œ ì§€ê°‘ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- ì €ì¥ ìƒíƒœ í‘œì‹œ -->
    <div class="save-status" id="saveStatus">
        íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!
    </div>

    <!-- ì£¼ë¬¸ ìƒì„¸ ëª¨ë‹¬ -->
    <div class="modal-overlay hidden" id="orderDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="orderDetailTitle">ğŸ“‹ ì£¼ë¬¸ ìƒì„¸ ì •ë³´</h3>
                <button class="modal-close" id="closeDetailModal">âœ•</button>
            </div>
            <div class="modal-body" id="orderDetailContent">
                <!-- ë™ì  ë‚´ìš© -->
            </div>
            <div class="modal-actions" id="orderDetailActions">
                <!-- ë™ì  ì•¡ì…˜ ë²„íŠ¼ -->
            </div>
        </div>
    </div>

    <!-- ì§€ê°‘ ì¶”ê°€/ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal-overlay hidden" id="walletModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="walletModalTitle">ğŸ‘› ìƒˆ ì§€ê°‘ ì¶”ê°€</h3>
                <button class="modal-close" id="closeWalletModal">âœ•</button>
            </div>
            <div class="modal-body">
                <form id="walletForm">
                    <div class="form-group">
                        <label class="form-label" id="labelWalletName">ì§€ê°‘ ì´ë¦„ *</label>
                        <input type="text" class="form-input" id="walletName" 
                               placeholder="ì˜ˆ: ë©”ì¸ TRC20 ì§€ê°‘" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" id="labelNetwork">ë„¤íŠ¸ì›Œí¬ *</label>
                            <select class="form-select" id="walletNetwork" required>
                                <option value="">ì„ íƒ</option>
                                <option value="TRC20">TRC20 (íŠ¸ë¡ )</option>
                                <option value="ERC20">ERC20 (ì´ë”ë¦¬ì›€)</option>
                                <option value="BEP20">BEP20 (BNB ìŠ¤ë§ˆíŠ¸ ì²´ì¸)</option>
                                <option value="Solana">Solana</option>
                                <option value="Polygon">Polygon</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" id="labelStatus">ìƒíƒœ</label>
                            <select class="form-select" id="walletStatus">
                                <option value="active">í™œì„±</option>
                                <option value="inactive">ë¹„í™œì„±</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" id="labelAddress">ì§€ê°‘ ì£¼ì†Œ *</label>
                        <textarea class="form-textarea" id="walletAddress" 
                                  placeholder="ì§€ê°‘ ì£¼ì†Œ ì…ë ¥" 
                                  rows="3" required></textarea>
                        <small style="color: #718096; font-size: 12px;" id="addressHelp">
                            * ì˜¬ë°”ë¥¸ ì§€ê°‘ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”. í˜•ì‹ì€ ë„¤íŠ¸ì›Œí¬ì— ë”°ë¼ ë‹¤ë¦…ë‹ˆë‹¤.
                        </small>
                    </div>

                    <div class="form-group">
                        <label class="form-label" id="labelQRCode">QR ì½”ë“œ ì´ë¯¸ì§€ (ì„ íƒì‚¬í•­)</label>
                        <input type="file" class="form-input" id="walletQRCode" 
                               accept="image/*">
                        <small style="color: #718096; font-size: 12px;" id="qrCodeHelp">
                            * ì§€ê°‘ ì£¼ì†Œì— ëŒ€í•œ QR ì½”ë“œ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”. (ê¶Œì¥ í¬ê¸°: 200x200px)
                        </small>
                    </div>

                    <div class="form-group">
                        <label class="form-label" id="labelMemo">ë©”ëª¨ (ì„ íƒì‚¬í•­)</label>
                        <textarea class="form-textarea" id="walletMemo" 
                                  placeholder="ì§€ê°‘ì— ëŒ€í•œ ì¶”ê°€ ì •ë³´" 
                                  rows="2"></textarea>
                    </div>

                    <input type="hidden" id="walletId">
                </form>
            </div>
            <div class="modal-actions">
                <button class="modal-button secondary" id="cancelWalletModal">ì·¨ì†Œ</button>
                <button class="modal-button primary" id="saveWallet">ì €ì¥</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== í…”ë ˆê·¸ë¨ ì•Œë¦¼ í´ë˜ìŠ¤ (ìˆ˜ì •ë¨) ====================
        class TelegramNotifier {
            constructor() {
                this.dataManager = new DataManager();
                this.settings = this.dataManager.getTelegramSettings();
            }

            // ì„¤ì • ì—…ë°ì´íŠ¸
            updateSettings(botToken, chatId) {
                this.settings = {
                    botToken: botToken,
                    chatId: chatId,
                    enabled: true
                };
                this.dataManager.saveTelegramSettings(this.settings);
                console.log('í…”ë ˆê·¸ë¨ ì„¤ì • ì—…ë°ì´íŠ¸ë¨');
                return this.settings;
            }

            // ì„¤ì • ìœ íš¨ì„± ê²€ì‚¬
            validateSettings() {
                if (!this.settings.botToken || !this.settings.chatId) {
                    return { valid: false, message: 'í…”ë ˆê·¸ë¨ ë´‡ í† í°ê³¼ ì±„íŒ… IDë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.' };
                }
                
                // í† í° í˜•ì‹ ê²€ì¦: ìˆ«ì:ë¬¸ìì—´
                const tokenPattern = /^\d+:[A-Za-z0-9_-]+$/;
                if (!tokenPattern.test(this.settings.botToken)) {
                    return { valid: false, message: 'ë´‡ í† í° í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ì˜ˆ: 1234567890:ABCdefGHIjklMNopQRstUVwxyz' };
                }
                
                // ì±„íŒ… ID í˜•ì‹ ê²€ì¦: ìˆ«ì ë˜ëŠ” @username
                const chatIdPattern = /^-?\d+$|^@[A-Za-z0-9_]+$/;
                if (!chatIdPattern.test(this.settings.chatId)) {
                    return { valid: false, message: 'ì±„íŒ… ID í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ìˆ«ì ë˜ëŠ” @username í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤.' };
                }
                
                return { valid: true, message: 'ì„¤ì •ì´ ìœ íš¨í•©ë‹ˆë‹¤.' };
            }

            // í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ì „ì†¡
            async sendTestNotification() {
                const validation = this.validateSettings();
                if (!validation.valid) {
                    return { success: false, error: validation.message };
                }

                try {
                    const message = this.escapeMessage(`âœ… *í…ŒìŠ¤íŠ¸ ì•Œë¦¼*\n\nê´€ë¦¬ì ì‹œìŠ¤í…œì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤!\nì‹œê°„: ${new Date().toLocaleString('ko-KR')}`);
                    
                    const result = await this.sendRawMessage(message);
                    
                    if (result.success) {
                        return { 
                            success: true, 
                            message: 'í…”ë ˆê·¸ë¨ í…ŒìŠ¤íŠ¸ ì•Œë¦¼ì´ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!',
                            data: result.data 
                        };
                    } else {
                        return { 
                            success: false, 
                            error: result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' 
                        };
                    }
                } catch (error) {
                    console.error('í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ì „ì†¡ ì¤‘ ì˜ˆì™¸ ë°œìƒ:', error);
                    return { 
                        success: false, 
                        error: `ì—°ê²° ì˜¤ë¥˜: ${error.message}. ì¸í„°ë„· ì—°ê²°ê³¼ ë´‡ í† í°, ì±„íŒ… IDë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.` 
                    };
                }
            }

            // ìƒˆ ì£¼ë¬¸ ì•Œë¦¼
            async sendNewOrderNotification(order) {
                const validation = this.validateSettings();
                if (!validation.valid) {
                    console.warn('í…”ë ˆê·¸ë¨ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤:', validation.message);
                    return;
                }

                try {
                    // ì£¼ë¬¸ ì •ë³´ í¬ë§·íŒ…
                    const statusText = {
                        'ì…ê¸ˆëŒ€ê¸°': 'ì…ê¸ˆ ëŒ€ê¸°',
                        'ì…ê¸ˆí™•ì¸': 'ì…ê¸ˆ í™•ì¸',
                        'ì²˜ë¦¬ì¤‘': 'ì²˜ë¦¬ ì¤‘',
                        'ì™„ë£Œ': 'ì™„ë£Œ',
                        'ì·¨ì†Œ': 'ì·¨ì†Œ'
                    }[order.status] || order.status;

                    // ìˆ˜ìˆ˜ë£Œ ê³„ì‚° (3%)
                    const fee = order.usdt * 0.03;
                    const netAmount = order.usdt - fee;
                    
                    // ë©”ì‹œì§€ ìƒì„± (íŠ¹ìˆ˜ë¬¸ì ì´ìŠ¤ì¼€ì´í”„)
                    const message = this.escapeMessage(
                        `ğŸš¨ *ìƒˆë¡œìš´ ì£¼ë¬¸ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤!*\n\n` +
                        `ğŸ“‹ *ì£¼ë¬¸ ID:* ${order.id}\n` +
                        `ğŸ’° *ê²°ì œ ê¸ˆì•¡:* ${order.amount.toLocaleString()} THB\n` +
                        `ğŸ’µ *USDT ê¸ˆì•¡:* ${netAmount.toFixed(4)} USDT\n` +
                        `ğŸ“Š *ìˆ˜ìˆ˜ë£Œ (3%):* ${fee.toFixed(4)} USDT\n` +
                        `â° *ìš”ì²­ ì‹œê°„:* ${new Date(order.time).toLocaleString('ko-KR')}\n` +
                        `ğŸ“ˆ *ìƒíƒœ:* ${statusText}\n\n` +
                        `ğŸ‘› *ì…ê¸ˆ ì§€ê°‘:* ${order.wallet ? order.wallet.name : 'ì§€ì •ë˜ì§€ ì•ŠìŒ'}\n` +
                        `ğŸ”— *ì£¼ì†Œ:* ${order.wallet ? (order.wallet.address.length > 30 ? 
                            order.wallet.address.substring(0, 15) + '...' + order.wallet.address.substring(order.wallet.address.length - 15) : 
                            order.wallet.address) : 'ì—†ìŒ'}\n\n` +
                        `ğŸ“ *ê²°ì œ ì¦ëª…ì„œ:* ${order.proof ? 'ì²¨ë¶€ë¨' : 'ì—†ìŒ'}\n\n` +
                        `âœ… *ë¹ ë¥¸ ì²˜ë¦¬ ìš”ë§*`
                    );

                    const result = await this.sendRawMessage(message);
                    
                    // ì´ë¯¸ì§€ê°€ ìˆìœ¼ë©´ ì „ì†¡
                    if (order.proof && order.proof.data && order.proof.type.startsWith('image/')) {
                        try {
                            await this.sendImage(order.id, order.proof.data, order.proof.type);
                            console.log('ì´ë¯¸ì§€ ì „ì†¡ ì‹œë„ ì™„ë£Œ');
                        } catch (imgError) {
                            console.warn('ì´ë¯¸ì§€ ì „ì†¡ ì‹¤íŒ¨:', imgError.message);
                        }
                    }

                    return result;
                } catch (error) {
                    console.error('ì£¼ë¬¸ ì•Œë¦¼ ì „ì†¡ ì¤‘ ì˜¤ë¥˜:', error);
                    return { success: false, error: error.message };
                }
            }

            // ì£¼ë¬¸ ìƒíƒœ ë³€ê²½ ì•Œë¦¼
            async sendStatusChangeNotification(orderId, oldStatus, newStatus) {
                const validation = this.validateSettings();
                if (!validation.valid) {
                    console.warn('í…”ë ˆê·¸ë¨ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤');
                    return;
                }

                try {
                    const oldStatusText = {
                        'ì…ê¸ˆëŒ€ê¸°': 'ì…ê¸ˆ ëŒ€ê¸°',
                        'ì…ê¸ˆí™•ì¸': 'ì…ê¸ˆ í™•ì¸',
                        'ì²˜ë¦¬ì¤‘': 'ì²˜ë¦¬ ì¤‘',
                        'ì™„ë£Œ': 'ì™„ë£Œ',
                        'ì·¨ì†Œ': 'ì·¨ì†Œ'
                    }[oldStatus] || oldStatus;

                    const newStatusText = {
                        'ì…ê¸ˆëŒ€ê¸°': 'ì…ê¸ˆ ëŒ€ê¸°',
                        'ì…ê¸ˆí™•ì¸': 'ì…ê¸ˆ í™•ì¸',
                        'ì²˜ë¦¬ì¤‘': 'ì²˜ë¦¬ ì¤‘',
                        'ì™„ë£Œ': 'ì™„ë£Œ',
                        'ì·¨ì†Œ': 'ì·¨ì†Œ'
                    }[newStatus] || newStatus;

                    const message = this.escapeMessage(
                        `ğŸ“Š *ì£¼ë¬¸ ìƒíƒœ ë³€ê²½ ì•Œë¦¼*\n\n` +
                        `ğŸ“‹ *ì£¼ë¬¸ ID:* ${orderId}\n` +
                        `ğŸ“ˆ *ì´ì „ ìƒíƒœ:* ${oldStatusText}\n` +
                        `âœ… *ìƒˆ ìƒíƒœ:* ${newStatusText}\n` +
                        `â° *ë³€ê²½ ì‹œê°„:* ${new Date().toLocaleString('ko-KR')}\n\n` +
                        `ğŸ”„ *ë³€ê²½ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤*`
                    );

                    return await this.sendRawMessage(message);
                } catch (error) {
                    console.error('ìƒíƒœ ë³€ê²½ ì•Œë¦¼ ì „ì†¡ ì¤‘ ì˜¤ë¥˜:', error);
                    return { success: false, error: error.message };
                }
            }

            // íŠ¹ìˆ˜ë¬¸ì ì´ìŠ¤ì¼€ì´í”„
            escapeMessage(text) {
                // Markdown íŠ¹ìˆ˜ë¬¸ì ì´ìŠ¤ì¼€ì´í”„
                const specialChars = ['_', '*', '[', ']', '(', ')', '~', '`', '>', '#', '+', '-', '=', '|', '{', '}', '.', '!'];
                
                let escaped = text;
                specialChars.forEach(char => {
                    escaped = escaped.split(char).join('\\' + char);
                });
                
                return escaped;
            }

            // ë©”ì‹œì§€ ì „ì†¡ (raw)
            async sendRawMessage(messageText) {
                try {
                    const url = `https://api.telegram.org/bot${this.settings.botToken}/sendMessage`;
                    
                    console.log('í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡ ì‹œë„:', {
                        url: url.replace(this.settings.botToken, 'TOKEN_HIDDEN'),
                        chat_id: this.settings.chatId,
                        message_length: messageText.length
                    });
                    
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: this.settings.chatId,
                            text: messageText,
                            parse_mode: 'MarkdownV2'
                        })
                    });

                    const data = await response.json();
                    
                    if (response.ok && data.ok) {
                        console.log('í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ');
                        return { success: true, data: data };
                    } else {
                        console.error('í…”ë ˆê·¸ë¨ API ì‘ë‹µ ì˜¤ë¥˜:', data);
                        let errorMessage = 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜';
                        
                        if (data.description) {
                            errorMessage = data.description;
                            if (errorMessage.includes('Forbidden')) {
                                errorMessage = 'ë´‡ì´ í•´ë‹¹ ì±„íŒ…ì— ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤. ë´‡ì„ ì±„íŒ…ì— ì¶”ê°€í•´ì£¼ì„¸ìš”.';
                            } else if (errorMessage.includes('chat not found')) {
                                errorMessage = 'ì±„íŒ…ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì±„íŒ… IDë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.';
                            } else if (errorMessage.includes('Bad Request')) {
                                errorMessage = 'ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤. ë´‡ í† í° í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
                            }
                        }
                        
                        return { success: false, error: errorMessage };
                    }
                } catch (error) {
                    console.error('í…”ë ˆê·¸ë¨ API í˜¸ì¶œ ì‹¤íŒ¨:', error);
                    let errorMessage = error.message;
                    
                    if (errorMessage.includes('Failed to fetch')) {
                        errorMessage = 'ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì˜¤ë¥˜. ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
                    }
                    
                    return { success: false, error: errorMessage };
                }
            }

            // ì´ë¯¸ì§€ ì „ì†¡
            async sendImage(orderId, base64Image, imageType) {
                try {
                    // base64 ë°ì´í„°ë¥¼ blobìœ¼ë¡œ ë³€í™˜
                    const base64Data = base64Image.split(',')[1];
                    const byteCharacters = atob(base64Data);
                    const byteNumbers = new Array(byteCharacters.length);
                    
                    for (let i = 0; i < byteCharacters.length; i++) {
                        byteNumbers[i] = byteCharacters.charCodeAt(i);
                    }
                    
                    const byteArray = new Uint8Array(byteNumbers);
                    const blob = new Blob([byteArray], { type: imageType });
                    
                    const formData = new FormData();
                    formData.append('chat_id', this.settings.chatId);
                    formData.append('photo', blob, `proof_${orderId}.png`);
                    formData.append('caption', `ğŸ“¸ ${orderId} ê²°ì œ ì¦ëª…ì„œ`);
                    
                    const url = `https://api.telegram.org/bot${this.settings.botToken}/sendPhoto`;
                    console.log('ì´ë¯¸ì§€ ì „ì†¡ ì‹œë„:', url.replace(this.settings.botToken, 'TOKEN_HIDDEN'));
                    
                    const response = await fetch(url, {
                        method: 'POST',
                        body: formData
                    });

                    const data = await response.json();
                    
                    if (response.ok && data.ok) {
                        console.log('ì´ë¯¸ì§€ ì „ì†¡ ì„±ê³µ');
                        return { success: true, data: data };
                    } else {
                        console.error('ì´ë¯¸ì§€ ì „ì†¡ ì‹¤íŒ¨:', data);
                        return { success: false, error: data.description || 'ì´ë¯¸ì§€ ì „ì†¡ ì‹¤íŒ¨' };
                    }
                } catch (error) {
                    console.error('ì´ë¯¸ì§€ ì „ì†¡ API í˜¸ì¶œ ì‹¤íŒ¨:', error);
                    return { success: false, error: error.message };
                }
            }
        }

        // ==================== ë°ì´í„° ê´€ë¦¬ì í´ë˜ìŠ¤ ====================
        class DataManager {
            constructor() {
                this.ORDERS_KEY = 'payment_orders';
                this.WALLETS_KEY = 'payment_wallets';
                this.SYNC_KEY = 'payment_sync_flag';
                this.ADMIN_SYNC_KEY = 'admin_sync_check';
                this.TELEGRAM_KEY = 'telegram_settings';
            }

            // ì£¼ë¬¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            getOrders() {
                try {
                    return JSON.parse(localStorage.getItem(this.ORDERS_KEY) || '[]');
                } catch (error) {
                    console.error('Error loading orders:', error);
                    return [];
                }
            }

            // ì£¼ë¬¸ ë°ì´í„° ì €ì¥í•˜ê¸°
            saveOrders(orders) {
                try {
                    localStorage.setItem(this.ORDERS_KEY, JSON.stringify(orders));
                    localStorage.setItem(this.SYNC_KEY, Date.now().toString());
                    return true;
                } catch (error) {
                    console.error('Error saving orders:', error);
                    return false;
                }
            }

            // ì§€ê°‘ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            getWallets() {
                try {
                    let wallets = JSON.parse(localStorage.getItem(this.WALLETS_KEY) || '[]');
                    
                    if (wallets.length === 0) {
                        wallets = [this.createDefaultWallet()];
                        this.saveWallets(wallets);
                    }
                    
                    return wallets;
                } catch (error) {
                    console.error('Error loading wallets:', error);
                    return [];
                }
            }

            // ì§€ê°‘ ë°ì´í„° ì €ì¥í•˜ê¸°
            saveWallets(wallets) {
                try {
                    localStorage.setItem(this.WALLETS_KEY, JSON.stringify(wallets));
                    localStorage.setItem(this.SYNC_KEY, Date.now().toString());
                    return true;
                } catch (error) {
                    console.error('Error saving wallets:', error);
                    return false;
                }
            }

            // ê¸°ë³¸ ì§€ê°‘ ìƒì„±
            createDefaultWallet() {
                return {
                    id: 'wallet_1',
                    name: 'ê¸°ë³¸ ì§€ê°‘ (TRC20)',
                    address: 'TXYZ1234567890abcdefghijklmnopqrstuvw',
                    network: 'TRC20',
                    qrCode: null,
                    isActive: true,
                    isDefault: true,
                    createdAt: new Date().toISOString()
                };
            }

            // í…”ë ˆê·¸ë¨ ì„¤ì • ì €ì¥/ë¡œë“œ
            saveTelegramSettings(settings) {
                try {
                    localStorage.setItem(this.TELEGRAM_KEY, JSON.stringify(settings));
                    return true;
                } catch (error) {
                    console.error('Error saving telegram settings:', error);
                    return false;
                }
            }

            getTelegramSettings() {
                try {
                    return JSON.parse(localStorage.getItem(this.TELEGRAM_KEY) || '{}');
                } catch (error) {
                    console.error('Error loading telegram settings:', error);
                    return {};
                }
            }

            // ë™ê¸°í™” ì²´í¬
            checkSync() {
                return localStorage.getItem(this.SYNC_KEY);
            }

            // ê´€ë¦¬ì ë™ê¸°í™” ì‹œê°„ ì—…ë°ì´íŠ¸
            updateAdminSync() {
                const syncTime = this.checkSync();
                localStorage.setItem(this.ADMIN_SYNC_KEY, syncTime || '0');
                return syncTime;
            }

            // ë™ê¸°í™” í•„ìš” ì—¬ë¶€ ì²´í¬
            needsSync() {
                const lastSync = this.checkSync();
                const lastAdminSync = localStorage.getItem(this.ADMIN_SYNC_KEY) || '0';
                return lastSync !== lastAdminSync;
            }

            // ì‚¬ìš©ì í˜ì´ì§€ì— ìƒíƒœ ì—…ë°ì´íŠ¸ ì•Œë¦¼
            notifyUserPage(orderId, newStatus) {
                try {
                    if (window.updateOrderStatusFromAdmin) {
                        window.updateOrderStatusFromAdmin(orderId, newStatus);
                    }
                } catch (e) {
                    console.log('ì‚¬ìš©ì í˜ì´ì§€ ì•Œë¦¼ ì‹¤íŒ¨');
                }
            }

            // ì‚¬ìš©ì í˜ì´ì§€ì— ì§€ê°‘ ì—…ë°ì´íŠ¸ ì•Œë¦¼ (ê°•í™”ë¨)
            notifyUserPageWallets(wallets) {
                try {
                    // 1. ì§€ê°‘ ë°ì´í„°ë¥¼ localStorageì— ì €ì¥
                    this.saveWallets(wallets);
                    
                    // 2. ì‚¬ìš©ì í˜ì´ì§€ì— ì§ì ‘ ì•Œë¦¼
                    if (window.updateWalletsFromAdmin) {
                        console.log('ì‚¬ìš©ì í˜ì´ì§€ì— ì§€ê°‘ ì—…ë°ì´íŠ¸ ì•Œë¦¼ ë³´ë‚´ê¸°:', wallets.length, 'ê°œ');
                        window.updateWalletsFromAdmin(wallets);
                    }
                    
                    // 3. ì´ë²¤íŠ¸ ë””ìŠ¤íŒ¨ì¹˜ (ëŒ€ì²´ ë°©ë²•)
                    if (typeof window.dispatchEvent === 'function') {
                        const event = new CustomEvent('walletDataUpdated', {
                            detail: { wallets: wallets }
                        });
                        window.dispatchEvent(event);
                    }
                    
                } catch (e) {
                    console.error('ì‚¬ìš©ì í˜ì´ì§€ ì§€ê°‘ ì•Œë¦¼ ì‹¤íŒ¨:', e);
                }
            }
        }

        // ==================== ì „ì—­ ë³€ìˆ˜ ====================
        const dataManager = new DataManager();
        const telegramNotifier = new TelegramNotifier();
        
        let allOrders = [];
        let allWallets = [];
        let currentFilter = 'all';
        let selectedOrder = null;
        let selectedWallet = null;
        let currentTab = 'orders';
        let qrCodeFile = null;
        let currentLang = 'ko';
        let syncCheckInterval = null;
        let exchangeRate = 35.5; // ê¸°ë³¸ í™˜ìœ¨

        // ë²ˆì—­ ë°ì´í„°
        const translations = {
            en: {
                adminTitle: "ğŸ“Š Order & Wallet Management System",
                adminSubtitle: "Manage user orders and wallet settings in one place",
                langSwitchText: "í•œêµ­ì–´",
                statTotalOrders: "Total Orders",
                statWaiting: "Waiting Deposit",
                statActiveWallets: "Active Wallets",
                statTodayRevenue: "Today's Revenue",
                statTodayAmount: "Today's Transaction",
                ordersTitle: "ğŸ“‹ Order List",
                walletsTitle: "ğŸ‘› Wallet List",
                thOrderId: "Order ID",
                thTime: "Time",
                thAmount: "Amount (THB)",
                thWallet: "Wallet",
                thStatus: "Status",
                thStep: "Step",
                thProof: "Proof",
                thAction: "Action",
                thWalletName: "Name",
                thNetwork: "Network",
                thAddress: "Address",
                thQRCode: "QR Code",
                thWalletStatus: "Status",
                thCreated: "Created",
                thWalletAction: "Action",
                noOrdersText: "No orders",
                noWalletsText: "No wallets. Please add a new wallet.",
                searchPlaceholder: "Search order ID...",
                statusAll: "All Status",
                statusWaiting: "Waiting Deposit",
                statusConfirmed: "Deposit Confirmed",
                statusProcessing: "Processing",
                statusCompleted: "Completed",
                statusCancelled: "Cancelled",
                exportBtn: "ğŸ“¥ Export",
                refreshBtn: "ğŸ”„ Refresh",
                addWalletBtn: "â• Add New Wallet",
                walletGuideTitle: "ğŸ’¡ Wallet Management Guide",
                walletGuideList: [
                    "You can add, edit, and delete multiple wallets.",
                    "<strong>Active wallets</strong> are displayed on the user page.",
                    "<strong>Default wallet</strong> cannot be deleted, but its active status can be changed.",
                    "You can upload QR code images for each wallet.",
                    "Manage wallets by network type."
                ],
                orderDetailTitle: "ğŸ“‹ Order Details",
                walletModalTitle: "ğŸ‘› Add New Wallet",
                labelWalletName: "Wallet Name *",
                labelNetwork: "Network *",
                labelStatus: "Status",
                labelAddress: "Wallet Address *",
                addressHelp: "* Enter correct wallet address. Format varies by network.",
                labelQRCode: "QR Code Image (Optional)",
                qrCodeHelp: "* Upload QR code image for wallet address. (Recommended size: 200x200px)",
                labelMemo: "Memo (Optional)",
                saveBtn: "Save",
                cancelBtn: "Cancel",
                statTotalChange: "All orders",
                waitingChange: "waiting",
                walletsChange: "available",
                revenueChange: "Fee 3%",
                amountChange: "Total amount",
                syncStatusText: "Real-time Sync"
            },
            ko: {
                adminTitle: "ğŸ“Š ì£¼ë¬¸ ë° ì§€ê°‘ ê´€ë¦¬ ì‹œìŠ¤í…œ",
                adminSubtitle: "í•œ ê³³ì—ì„œ ì‚¬ìš©ì ì£¼ë¬¸ê³¼ ì§€ê°‘ ì„¤ì •ì„ ê´€ë¦¬í•˜ì„¸ìš”",
                langSwitchText: "English",
                statTotalOrders: "ì´ ì£¼ë¬¸",
                statWaiting: "ì…ê¸ˆ ëŒ€ê¸°",
                statActiveWallets: "í™œì„± ì§€ê°‘",
                statTodayRevenue: "ì˜¤ëŠ˜ ìˆ˜ìµ",
                statTodayAmount: "ì˜¤ëŠ˜ ê±°ë˜ì•¡",
                ordersTitle: "ğŸ“‹ ì£¼ë¬¸ ëª©ë¡",
                walletsTitle: "ğŸ‘› ì§€ê°‘ ëª©ë¡",
                thOrderId: "ì£¼ë¬¸ ID",
                thTime: "ì‹œê°„",
                thAmount: "ê¸ˆì•¡ (THB)",
                thWallet: "ì§€ê°‘",
                thStatus: "ìƒíƒœ",
                thStep: "ë‹¨ê³„",
                thProof: "ì¦ëª…ì„œ",
                thAction: "ì‘ì—…",
                thWalletName: "ì´ë¦„",
                thNetwork: "ë„¤íŠ¸ì›Œí¬",
                thAddress: "ì£¼ì†Œ",
                thQRCode: "QR ì½”ë“œ",
                thWalletStatus: "ìƒíƒœ",
                thCreated: "ìƒì„±ì¼",
                thWalletAction: "ì‘ì—…",
                noOrdersText: "ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤",
                noWalletsText: "ì§€ê°‘ì´ ì—†ìŠµë‹ˆë‹¤. ìƒˆ ì§€ê°‘ì„ ì¶”ê°€í•˜ì„¸ìš”.",
                searchPlaceholder: "ì£¼ë¬¸ ID ê²€ìƒ‰...",
                statusAll: "ëª¨ë“  ìƒíƒœ",
                statusWaiting: "ì…ê¸ˆ ëŒ€ê¸°",
                statusConfirmed: "ì…ê¸ˆ í™•ì¸",
                statusProcessing: "ì²˜ë¦¬ì¤‘",
                statusCompleted: "ì™„ë£Œ",
                statusCancelled: "ì·¨ì†Œ",
                exportBtn: "ğŸ“¥ ë‚´ë³´ë‚´ê¸°",
                refreshBtn: "ğŸ”„ ìƒˆë¡œê³ ì¹¨",
                addWalletBtn: "â• ìƒˆ ì§€ê°‘ ì¶”ê°€",
                walletGuideTitle: "ğŸ’¡ ì§€ê°‘ ê´€ë¦¬ ì•ˆë‚´",
                walletGuideList: [
                    "ì—¬ëŸ¬ ê°œì˜ ì§€ê°‘ì„ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                    "<strong>í™œì„± ì§€ê°‘</strong>ì€ ì‚¬ìš©ì í˜ì´ì§€ì— í‘œì‹œë©ë‹ˆë‹¤.",
                    "<strong>ê¸°ë³¸ ì§€ê°‘</strong>ì€ ì‚­ì œí•  ìˆ˜ ì—†ì§€ë§Œ í™œì„± ìƒíƒœëŠ” ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                    "ê° ì§€ê°‘ì— ëŒ€í•œ QR ì½”ë“œ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                    "ë„¤íŠ¸ì›Œí¬ ìœ í˜•ë³„ë¡œ ì§€ê°‘ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
                ],
                orderDetailTitle: "ğŸ“‹ ì£¼ë¬¸ ìƒì„¸ ì •ë³´",
                walletModalTitle: "ğŸ‘› ìƒˆ ì§€ê°‘ ì¶”ê°€",
                labelWalletName: "ì§€ê°‘ ì´ë¦„ *",
                labelNetwork: "ë„¤íŠ¸ì›Œí¬ *",
                labelStatus: "ìƒíƒœ",
                labelAddress: "ì§€ê°‘ ì£¼ì†Œ *",
                addressHelp: "* ì˜¬ë°”ë¥¸ ì§€ê°‘ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”. í˜•ì‹ì€ ë„¤íŠ¸ì›Œí¬ì— ë”°ë¼ ë‹¤ë¦…ë‹ˆë‹¤.",
                labelQRCode: "QR ì½”ë“œ ì´ë¯¸ì§€ (ì„ íƒì‚¬í•­)",
                qrCodeHelp: "* ì§€ê°‘ ì£¼ì†Œì— ëŒ€í•œ QR ì½”ë“œ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”. (ê¶Œì¥ í¬ê¸°: 200x200px)",
                labelMemo: "ë©”ëª¨ (ì„ íƒì‚¬í•­)",
                saveBtn: "ì €ì¥",
                cancelBtn: "ì·¨ì†Œ",
                statTotalChange: "ì „ì²´ ì£¼ë¬¸",
                waitingChange: "ëŒ€ê¸°ì¤‘",
                walletsChange: "ì‚¬ìš© ê°€ëŠ¥",
                revenueChange: "ìˆ˜ìˆ˜ë£Œ 3%",
                amountChange: "ì´ ê±°ë˜ì•¡",
                syncStatusText: "ì‹¤ì‹œê°„ ë™ê¸°í™”"
            }
        };

        // ==================== í˜ì´ì§€ ì´ˆê¸°í™” ====================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ê´€ë¦¬ì í˜ì´ì§€ ë¡œë“œë¨');
            
            // ì˜¤ëŠ˜ ë‚ ì§œ ì„¤ì •
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('dateFrom').value = today;
            document.getElementById('dateTo').value = today;
            
            // ì–¸ì–´ ì´ˆê¸°í™”
            currentLang = 'ko';
            
            // í…”ë ˆê·¸ë¨ ì„¤ì • ë¡œë“œ
            loadTelegramSettings();
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            setupEventListeners();
            
            // ë°ì´í„° ë¡œë“œ
            loadAllData();
            
            // í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            try {
                updateAllText();
            } catch (error) {
                console.error('í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ì¤‘ ì—ëŸ¬:', error);
                setTimeout(updateAllText, 100);
            }
            
            // ë™ê¸°í™” ì²´í¬ ì‹œì‘
            startSyncCheck();
            
            // í™˜ìœ¨ ë¡œë“œ (ê°„ë‹¨í•œ ë°©ì‹)
            loadExchangeRate();
            
            console.log('ê´€ë¦¬ì í˜ì´ì§€ ì´ˆê¸°í™” ì™„ë£Œ');
        });

        // ==================== ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ====================
        function setupEventListeners() {
            // ì–¸ì–´ ì „í™˜ ë²„íŠ¼
            document.getElementById('langSwitchBtn').addEventListener('click', toggleLanguage);
            
            // íƒ­ ì „í™˜
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', switchTab);
            });
            
            // ì£¼ë¬¸ ê´€ë¦¬ í•„í„°
            document.getElementById('statusFilter').addEventListener('change', updateOrders);
            document.getElementById('searchOrder').addEventListener('input', updateOrders);
            document.getElementById('dateFrom').addEventListener('change', updateOrders);
            document.getElementById('dateTo').addEventListener('change', updateOrders);
            document.getElementById('refreshOrders').addEventListener('click', () => loadAllData());
            document.getElementById('exportOrders').addEventListener('click', exportOrdersToExcel);
            
            // ì§€ê°‘ ê´€ë¦¬ í•„í„°
            document.getElementById('walletStatusFilter').addEventListener('change', updateWallets);
            document.getElementById('walletNetworkFilter').addEventListener('change', updateWallets);
            document.getElementById('refreshWallets').addEventListener('click', () => loadAllData());
            document.getElementById('addWallet').addEventListener('click', openAddWalletModal);
            
            // ëª¨ë‹¬ ë‹«ê¸°
            document.getElementById('closeDetailModal').addEventListener('click', closeOrderDetail);
            document.getElementById('closeWalletModal').addEventListener('click', closeWalletModal);
            document.getElementById('cancelWalletModal').addEventListener('click', closeWalletModal);
            
            // ì§€ê°‘ ëª¨ë‹¬ ì €ì¥
            document.getElementById('saveWallet').addEventListener('click', saveWallet);
            document.getElementById('walletQRCode').addEventListener('change', handleQRCodeUpload);
            
            // í…”ë ˆê·¸ë¨ ì„¤ì •
            document.getElementById('testTelegramBtn').addEventListener('click', testTelegramNotification);
            document.getElementById('telegramBotToken').addEventListener('change', saveTelegramConfig);
            document.getElementById('telegramChatId').addEventListener('change', saveTelegramConfig);
            
            // ì§€ê°‘ í¼ ì œì¶œ ë°©ì§€
            document.getElementById('walletForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveWallet();
            });
        }

        // ==================== í™˜ìœ¨ ë¡œë“œ ====================
        function loadExchangeRate() {
            // ê°„ë‹¨í•œ í™˜ìœ¨ (ì‹¤ì œ API ì‚¬ìš© ì‹œ ìˆ˜ì •)
            exchangeRate = 35.5;
            console.log('í™˜ìœ¨ ì„¤ì •:', exchangeRate);
        }

        // ==================== í…”ë ˆê·¸ë¨ ì„¤ì • ====================
        function loadTelegramSettings() {
            const settings = dataManager.getTelegramSettings();
            const tokenInput = document.getElementById('telegramBotToken');
            const chatIdInput = document.getElementById('telegramChatId');
            
            if (tokenInput && settings.botToken) {
                tokenInput.value = settings.botToken;
            }
            
            if (chatIdInput && settings.chatId) {
                chatIdInput.value = settings.chatId;
            }
        }

        function saveTelegramConfig() {
            const botToken = document.getElementById('telegramBotToken').value.trim();
            const chatId = document.getElementById('telegramChatId').value.trim();
            
            telegramNotifier.updateSettings(botToken, chatId);
            updateTelegramStatus('ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        }

        async function testTelegramNotification() {
            const telegramStatus = document.getElementById('telegramStatus');
            telegramStatus.textContent = 'ì „ì†¡ ì¤‘...';
            telegramStatus.className = 'telegram-status';
            
            const result = await telegramNotifier.sendTestNotification();
            
            if (result.success) {
                telegramStatus.textContent = 'âœ… í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ì „ì†¡ ì„±ê³µ!';
                telegramStatus.className = 'telegram-status success';
            } else {
                telegramStatus.textContent = `âŒ ì „ì†¡ ì‹¤íŒ¨: ${result.error}`;
                telegramStatus.className = 'telegram-status error';
            }
        }

        function updateTelegramStatus(message, type) {
            const telegramStatus = document.getElementById('telegramStatus');
            if (telegramStatus) {
                telegramStatus.textContent = message;
                telegramStatus.className = `telegram-status ${type}`;
                
                // 5ì´ˆ í›„ ë©”ì‹œì§€ ì§€ì›€
                setTimeout(() => {
                    telegramStatus.textContent = '';
                    telegramStatus.className = 'telegram-status';
                }, 5000);
            }
        }

        // ==================== í†µê³„ ì—…ë°ì´íŠ¸ (ìˆ˜ì •ë¨ - ì˜¬ë°”ë¥¸ ìˆ˜ìˆ˜ë£Œ ê³„ì‚°) ====================
        function updateStats() {
            const totalOrders = allOrders.length;
            const waitingOrders = allOrders.filter(o => o.status === 'ì…ê¸ˆëŒ€ê¸°').length;
            const activeWallets = allWallets.filter(w => w.isActive).length;
            
            // ì˜¤ëŠ˜ ë‚ ì§œ
            const today = new Date().toISOString().split('T')[0];
            
            // ì˜¤ëŠ˜ ì™„ë£Œëœ ì£¼ë¬¸ë“¤
            const todayOrders = allOrders.filter(o => {
                const orderDate = o.time.split('T')[0];
                return orderDate === today && o.status === 'ì™„ë£Œ';
            });
            
            // ì˜¤ëŠ˜ ê±°ë˜ì•¡ ê³„ì‚° (THBì™€ USDT ë³„ë„)
            let todayAmountTHB = 0;
            let todayAmountUSDT = 0;
            let todayRevenueUSDT = 0;
            
            todayOrders.forEach(order => {
                todayAmountTHB += order.amount;
                
                // USDT ê±°ë˜ì•¡ (ìˆ˜ìˆ˜ë£Œ ì œì™¸í•œ ì‹¤ì œ ë°›ì€ ê¸ˆì•¡)
                const netUSDT = order.usdt; // ì´ë¯¸ ìˆ˜ìˆ˜ë£Œê°€ í¬í•¨ëœ ì´ì•¡
                todayAmountUSDT += netUSDT;
                
                // ìˆ˜ìˆ˜ë£Œ ê³„ì‚° (ì´ì•¡ì˜ 3%ê°€ ìˆ˜ìˆ˜ë£Œ)
                const feeUSDT = netUSDT * 0.03 / 1.03; // ìˆ˜ìˆ˜ë£Œ 3%
                todayRevenueUSDT += feeUSDT;
            });
            
            // USDT ìˆ˜ìµì„ THBë¡œ ë³€í™˜
            const todayRevenueTHB = Math.round(todayRevenueUSDT * exchangeRate);
            
            // DOM ìš”ì†Œ ì—…ë°ì´íŠ¸
            const updateIfExists = (id, value) => {
                const element = document.getElementById(id);
                if (element) element.textContent = value;
            };
            
            updateIfExists('totalOrders', totalOrders);
            updateIfExists('waitingOrders', waitingOrders);
            updateIfExists('activeWallets', activeWallets);
            updateIfExists('todayRevenue', todayRevenueTHB.toLocaleString() + ' THB');
            updateIfExists('todayRevenueUSDT', '(' + todayRevenueUSDT.toFixed(2) + ' USDT)');
            updateIfExists('todayAmount', todayAmountTHB.toLocaleString() + ' THB');
            updateIfExists('todayAmountUSDT', '(' + todayAmountUSDT.toFixed(2) + ' USDT)');
            
            const trans = translations[currentLang];
            const waitingChangeEl = document.getElementById('waitingChange');
            const walletsChangeEl = document.getElementById('walletsChange');
            
            if (waitingChangeEl) {
                waitingChangeEl.textContent = `${waitingOrders} ${trans.waitingChange}`;
                if (waitingOrders > 0) {
                    waitingChangeEl.classList.remove('negative');
                } else {
                    waitingChangeEl.classList.add('negative');
                }
            }
            
            if (walletsChangeEl) {
                walletsChangeEl.textContent = `${activeWallets} ${trans.walletsChange}`;
            }
            
            console.log('í†µê³„ ì—…ë°ì´íŠ¸:', {
                todayOrders: todayOrders.length,
                todayAmountTHB: todayAmountTHB,
                todayAmountUSDT: todayAmountUSDT,
                todayRevenueTHB: todayRevenueTHB,
                todayRevenueUSDT: todayRevenueUSDT,
                exchangeRate: exchangeRate
            });
        }

        // ==================== ë‚˜ë¨¸ì§€ í•¨ìˆ˜ë“¤ (ì´ì „ê³¼ ë™ì¼) ====================
        // [ì´ì „ ì½”ë“œì˜ ë‚˜ë¨¸ì§€ í•¨ìˆ˜ë“¤ ìœ ì§€...]
        // ë‹¨, updateOrderStatus í•¨ìˆ˜ì— í…”ë ˆê·¸ë¨ ì•Œë¦¼ ë¶€ë¶„ì´ ì´ë¯¸ í¬í•¨ë˜ì–´ ìˆìŒ
        
        // ==================== ì‚¬ìš©ì í˜ì´ì§€ í†µì‹  í•¨ìˆ˜ ====================
        window.newOrderFromUser = async function(order) {
            console.log('ì‚¬ìš©ìë¡œë¶€í„° ìƒˆ ì£¼ë¬¸ ë°›ìŒ:', order.id);
            
            // ì£¼ë¬¸ ì¶”ê°€
            allOrders.unshift(order);
            dataManager.saveOrders(allOrders);
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            updateStats();
            updateOrders();
            
            // í…”ë ˆê·¸ë¨ ì•Œë¦¼ ì „ì†¡
            const telegramResult = await telegramNotifier.sendNewOrderNotification(order);
            if (telegramResult && !telegramResult.success) {
                console.warn('í…”ë ˆê·¸ë¨ ì•Œë¦¼ ì „ì†¡ ì‹¤íŒ¨:', telegramResult.error);
            }
            
            // ì•Œë¦¼ í‘œì‹œ
            showNotification(`ìƒˆ ì£¼ë¬¸ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤: ${order.id}`);
            
            return { success: true, message: 'ì£¼ë¬¸ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤' };
        };

        // ë‚˜ë¨¸ì§€ í•¨ìˆ˜ë“¤ì€ ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€í•˜ë˜, í…”ë ˆê·¸ë¨ ê´€ë ¨ ì˜¤ë¥˜ ìˆ˜ì •ëœ ë¶€ë¶„ë§Œ ì ìš©
    </script>
</body>
</html>
